# Telegram Bot для рассылки

Готовое приложение Telegram-бота на Python с использованием библиотеки aiogram для управления подписками и рассылки сообщений.

## Функционал

### Для пользователей:
- `/start` - Подписаться на рассылку
- `/unsubscribe` - Отписаться от рассылки  
- `/help` - Показать справку по командам

### Для администратора:
- `/send <текст>` - Отправить рассылку всем подписчикам
- `/stats` - Показать статистику подписок
- `/help` - Показать справку (включая админские команды)

## Установка и запуск

### 1. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 2. Настройка конфигурации
Отредактируйте файл `config.py`:

```python
# Токен бота (получить у @BotFather)
BOT_TOKEN = "ВАШ_ТОКЕН_БОТА"

# ID администратора (ваш Telegram ID)
ADMIN_ID = ВАШ_TELEGRAM_ID
```

**Важно:** Файл `config.py` не загружается в GitHub из соображений безопасности!

**Как получить токен бота:**
1. Напишите @BotFather в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям
4. Скопируйте полученный токен

**Как узнать свой Telegram ID:**
1. Напишите @userinfobot в Telegram
2. Он пришлет ваш ID

### 3. Запуск бота
```bash
python main.py
```

## Структура проекта

```
tg_bot_subs/
├── main.py          # Запуск бота
├── database.py      # Работа с SQLite базой данных
├── config.py        # Конфигурация (токен, ADMIN_ID)
├── handlers.py      # Обработчики команд
├── requirements.txt # Зависимости Python
├── Procfile         # Для деплоя на Railway/Heroku
└── README.md        # Документация
```

## Загрузка на GitHub

### Первоначальная настройка репозитория:

1. **Создайте новый репозиторий на GitHub**

2. **Инициализируйте Git в папке проекта:**
   ```bash
   git init
   git add .
   git commit -m "Initial commit: Telegram bot for subscriptions"
   ```

3. **Подключите к GitHub репозиторию:**
   ```bash
   git remote add origin https://github.com/ВАШ_USERNAME/ВАШ_РЕПОЗИТОРИЙ.git
   git branch -M main
   git push -u origin main
   ```

4. **Настройте config.py локально:**
   ```bash
   # Отредактируйте config.py со своими данными
   ```

**Важно:** Файл `config.py` не будет загружен в GitHub благодаря `.gitignore`!

## Деплой на Railway

1. Создайте аккаунт на [Railway](https://railway.app)
2. Подключите ваш GitHub репозиторий
3. В настройках проекта добавьте переменные окружения:
   - `BOT_TOKEN` - токен вашего бота
   - `ADMIN_ID` - ваш Telegram ID
4. Railway автоматически запустит бота

## Деплой на Heroku

1. Установите [Heroku CLI](https://devcenter.heroku.com/articles/heroku-cli)
2. Создайте приложение:
   ```bash
   heroku create your-bot-name
   ```
3. Добавьте переменные окружения:
   ```bash
   heroku config:set BOT_TOKEN=ваш_токен
   heroku config:set ADMIN_ID=ваш_id
   ```
4. Деплой:
   ```bash
   git push heroku main
   ```

## База данных

Бот использует SQLite базу данных `bot_users.db` с таблицей `users`:
- `user_id` - ID пользователя в Telegram
- `username` - имя пользователя (@username)
- `first_name` - имя
- `last_name` - фамилия
- `subscribed_at` - дата подписки

## Особенности

- ✅ Автоматическое создание базы данных при первом запуске
- ✅ Обработка ошибок при отправке сообщений (заблокированные боты)
- ✅ Логирование всех операций
- ✅ Проверка прав администратора
- ✅ Статистика рассылок
- ✅ Готовность к деплою

## Логирование

Все операции логируются в консоль с указанием времени и уровня важности:
- INFO - обычные операции
- ERROR - ошибки
- WARNING - предупреждения

## Безопасность

- Токен бота хранится в отдельном конфигурационном файле
- Проверка прав администратора для команд управления
- Обработка исключений для предотвращения падения бота
